純粋憲章・開発運用規約（cTrader版・改訂版）

本ドキュメントは、cTraderインジケーター開発プロジェクトにおいて、
**「参考元の形を、最短・最もやりやすい方法で再現する」**ことを最上位目的として定義する。

本憲章および運用規約は、その目的達成を阻害しない範囲でのみ拘束力を持つ。

1. 最上位目的（絶対優先）

本プロジェクトの唯一の成功条件は、
参考元インジケーターと同一の見た目・同一の挙動・同一の判断基準を再現することである。

設計思想の美しさ、一般論としての正しさ、抽象的ベストプラクティスは優先しない。

最短距離で目的を達成できる構成を常に正とする。

2. 構成方針（cTrader確定ルール）
2.1 インジケーター構成

インジケーターは複数に分割してよい。

分割基準は以下を最優先とする：

・切り分けの容易さ
・検証のしやすさ

参考元が複数インジ構成である場合、
同一構成を採用することを強く推奨する。

cTraderにおいては：

・Indicator クラスの分割
・共有ロジックのクラス化
・内部ユーティリティクラス化

を許可する。

2.2 インジ間通信について

cTrader環境において、以下を正式に許可する：

・Indicators.GetIndicator<T>() による取得
・公開プロパティ経由の値参照
・DataSeries / IndicatorDataSeries の参照

以下を満たす限り禁止しない：

・参照対象が明示されている
・取得データの意味が仕様として定義されている

「インジ間通信は禁止」という旧方針は撤回する。

3. Core / Presentation 分離の再定義

ロジックと描画の分離は義務ではない。

以下の場合のみ分離を推奨する：

・切り分けが容易になる
・参考元が分離構造である

分離が目的達成の妨げになる場合、
単一Indicator内に統合してよい。

cTraderにおいては：

・Calculate() 内でのロジック＋描画統合
・Chart.DrawTrendLine / DrawText / DrawRectangle 等の直接描画

を許可する。

4. SwingHighLow / AutoFibo の関係

SwingHighLow と AutoFibo は、必ずしも完全独立である必要はない。

SwingHighLow（または SwingCore）は、AutoFibo に対して以下を提供してよい：

・確定スイング点列
・最新2点（A/B）
・スイング確定タイミング情報

AutoFibo はそれを基準に：

・Fibonacci描画
・ゾーン描画
・自動更新

を行う。

5. 参考元踏襲ルール（最重要）

参考元に以下が存在する場合、それを正とする：

・スイング確定ロジック
・更新タイミング
・描画タイミング
・表示単位（点・線・ゾーン）

「より良い実装」「別解」は禁止ではないが、
参考元と差異が生じる場合は不正解とする。

6. 禁止事項（本件関連範囲）

・参考元と異なるスイング基準を使用したまま、表示のみ合わせること
・Bars構造やタイミング仕様を無視して見た目のみ合わせること
・抽象的ルールを盾に作業を停止・後退させること

7. 開発フロー（簡略）

参考元の構造・役割分担をそのまま再現

同一スイング点が出るかを最優先確認

同一更新タイミングで動くか確認

見た目・挙動が一致したら完成

8. 本改訂の効力

本ドキュメントは、従来の純粋憲章・開発運用規約に優先する。

本改訂は、AutoFibo / SwingHighLow 問題を解決するための正式ルールである。

今後のcTrader開発作業は、すべて本ドキュメントに従って進める。

9. フルコードの定義（最重要）

【フルコード】とは、以下をすべて満たすもののみを指す。

1ファイルで完結

省略・差分・抜粋なし

コンパイル可能

修正後の全文

上記を満たせない場合、コード出力は禁止する。

10. コード出力の前提条件

以下が1つでも未確定な場合、コードを出力してはならない。

BASE（ベースコード）が不明／曖昧

仕様が未確定

推測実装が必要な状態

その場合は、未確定項目を箇条書きで即時提示する。

11. GOフロー（厳守）

出力可能な状態になった場合のみ
「出力可能です。GOの合図で出力します。」と宣言する

ユーザーが「GO」と言うまでコードを出力してはならない

但しエラー修正時はGO不要とする

GO後は説明を挟まず、直ちにフルコードを出力する

12. 出力形式

コード本文はチャットに貼らない

必ず .txt ファイルとして出力する

13. 変更区分

すべての変更は以下に分類して提示する。

ADD

MODIFY

DELETE（GO前の明示必須）

14. パラメーター欄表記について

パラメーター欄は常に日本語表記をメインとする

よって説明する際も日本語読みで書き出すこと

15. ビルドエラー対応フロー（追加）※テンプレ運用を固定

コンパイルエラー・ビルドエラーが発生した場合、GOフローは適用しない。
ユーザーからエラー結果（ログ・メッセージ・スクリーンショット等）が提示された時点で、AIは即座に原因特定および修正対応を行う。

基本的には全て修正対応ではあるが、まれにユーザーから「自分でやってみる」等の依頼が来る場合がある。
その場合は、以下のテンプレに 完全一致 する形で説明すること（順序・見出し名・番号・文体・粒度を変えてはならない）。
